<!DOCTYPE html>
<html>
<head>
  <title>Gateway - API landing page</title>
  <style>
    body {
      font-family: helvetica;
    }
    .code {
      font-family: monospace;
      background-color: #ccc;
      padding: 0.5em;
      margin: 0.5em;
    }
  </style>
</head>
<body>
  <center>
    <h1>Gateway.cash API Docs</h1>
  </center>
  <p>
    You've reached the backend server API documentation landing page. This
    server may be used to interface with the <a href="https://gateway.cash"
    target="_blank">gateway.cash</a> payment processor.
  </p>
  <h2>Overview</h2>
  <p>
    The API is served over HTTP or HTTPS with your current URL as a basepoint.
    If you are running a local instance of the server at http://127.0.0.1:8080/
    then your requests will start with that URL.
  </p>
  <p>
    For example, the endpoint for /login would be http://127.0.0.1:8080/login
    on your local instance. The examples in this documentation assume you are
    using a basepoint URL of https://api.gateway.cash/ which is the production
    server Gateway uses across all of our services.
  </p>
  <p>
    You are free to use our API server as you wish. If we receive excessive
    spam we may choose to block your access. Like all open-source projects, you
    are also free to run your own server on the internet if you wish.
  </p>
  <h2>Contents</h2>
  <ul>
    <li><a href="#gatewayapi">The Gateway API</a></li>
    <li><a href="#apirequests">API Requests</a></li>
    <li><a href="#endpoints">API Endpoints</a></li>
    <li><a href="#getlogin">GET /login</a></li>
    <li><a href="#postregister">POST /register</a></li>
    <li><a href="#postpay">POST /pay</a></li>
    <li><a href="#postpaid">POST /paid</a></li>
    <li><a href="#getmerchantid">GET /merchantid</a></li>
    <li><a href="#getusername">GET /username</a></li>
    <li><a href="#postusername">POST /username</a></li>
    <li><a href="#getpayments">GET /payments</a></li>
    <li><a href="#gettotalsales">GET /totalsales</a></li>
    <li><a href="#getaddress">GET /address</a></li>
    <li><a href="#postaddress">POST /address</a></li>
  </ul>
  <h2 id="gatewayapi">The Gateway API</h2>
  <p>
    The Gateway API can be used by merchants and customers to access invoices,
    manage orders and make payments. Merchant API keys are required in order to
    access invoices and account information.
  </p>
  <p>
    No API keys are required when making or confirming a payment.
  </p>
  <h2 id="apirequests">API Requests</h2>
  <p>
    Making a request to the API will result in a JSON object string being
    returned. The "status" property of the object will either be "success" or
    "error" for all requests.
  </p>
  <p>
    In the case of an error, the "error" property will contain a brief error
    message and "description" will contain a more in-depth description of the
    problem, suitable for showing to your users.
  </p>
  <p>
    In the case of a "success" status field, the object will contain the
    relevant information as described below for each endpoint.
  </p>
  <h2 id="endpoints">API Endpoints</h2>
  <h3 id="getlogin">GET /login</h3>
  <p>
    Validates a given session, returning the API key. The API key is required to
    access merchant- and account-related endpoints.
  </p>
  <p>
    The address must be a Bitcoin Cash address. If it is not in the CashAddress
    format it will be translated.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"username" or "address" is required</li>
    <li>"password" is required</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
GET https://api.gateway.cash/login
?address=bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng
&password=Super$ecret1
  </pre>
  <pre class="code">
GET https://api.gateway.cash/login
?username=JohnGalt12
&password=IHeartDagney
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "APIKey": "aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "error": "Invalid Login",
  "description": "An incorrect address, username or password was provided."
}
  </pre>
  <h3 id="postregister">POST /register</h3>
  <p>
    Creates a new merchant account and generates an API key, merchant ID and
    other account information for the user. Once registration is complete,
    the newly-generated API key is returned to the user.
  </p>
  <p>
    The address must be a valid Bitcoin Cash address. If not given in
    CashAddress format, it will be translated.
  </p>
  <p>
    The username must be between 5 and 24 characters, must be unique, must not
    contain spaces or other odd characters, and is an optional parameter at
    registration time. Usernames can always be set later with the /setusername
    endpoint.
  </p>
  <p>
    The password must be secure, unique and must not contain odd characters such
    as returns, tabs or spaces.
  </p>
  <p>
    <b>BE AWARE:</b> The API does not validate that passwords are secure or have
    entropy. It is the responsibility of the user and/or the front-end
    software provider to ensure that  a secure password is provided. Passwords
    are always salted and hashed prior to storing in a database.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"address" is required</li>
    <li>"password" is required</li>
    <li>"username" is optional</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
POST https://api.gateway.cash/register
{
  "address": "bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng",
  "username": "FidelCastr0",
  "password": "PowerPowerNomNomN0m"
}
  </pre>
  <pre class="code">
POST https://api.gateway.cash/register
{
  "address": "bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng",
  "password": "PowerPowerNomNomN0m"
}
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "APIKey": "aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "error": "Address in use",
  "description": "It looks like that address is already being used by
  another user! If this is your address, send an email to
  support@gateway.cash and we'll help you get access to this merchant
  account."
}
  </pre>
  <h3 id="postpay">POST /pay</h3>
  <p>
    Generates an invoice, returning the payment address to the user when the
    user gives the merchant ID. No API key is required for this API call.
  </p>
  <p>
    Payment IDs can also be sent which will be given to the merchant in order
    that they can track their orders.
  </p>
  <p>
    Callback URLs can be sent which will be invoked by the server when the
    payment is received. Callbacks are sent as POST requests and will always
    contain a "secret" value which is the SHA256 hash of the merchant's API key.
  </p>
  <p>
    <b>BE AWARE:</b> Merchants who leverage callback URLs MUST ALWAYS VERIFY
    that the request is authentic by making sure the "secret" provided is the
    SHA256 hash of the merchant's API key. API keys can be viewed and changed in
    the Settings screen.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"merchantID" is required</li>
    <li>"paymentID" is optional</li>
    <li>"callbackURL" is optional</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
POST https://api.gateway.cash/pay
{
  "merchantID": "deadbeef20181234"
}
  </pre>
  <pre class="code">
POST https://api.gateway.cash/pay
{
  "merchantID": "deadbeef20181234",
  "paymentID": "123001456789789789-1223",
  "callbackURL": "https://my.super.store/something.php"
}
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status", "success",
  "paymentAddress": "bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "error": "Invalid Merchant ID",
  "description": "The merchant ID you provided wasn't found in the database.
  Make sure you're sending the correct Merchant ID."
}
  </pre>
  <h3 id="postpaid">POST /paid</h3>
  <p>
    Called by the user once they have made their payment. If the user doesn't
    make an API call to this endpoint, the payment will still eventually get
    picked up by the broken payments service within 24 hours. No API key is
    required to use this endpoint.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"paymentAddress" is required</li>
    <li>"paymentTXID" is required</li>
  </ul>
  <h4>Example</h4>
  <pre class="code">
{
  "paymentAddress": "bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng",
  "paymentTXID": "abcdefabcdef01234567890123456789ababababacadeaf"
}
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "error": "Payment Already Pending",
  "description": "A payment with that payment address and payment TXID has
  already been added to the pending payments queue."
}
  </pre>
  <h3 id="getmerchantid">GET /merchantid</h3>
  <p>Returns the merchant ID of a user given their API key.</p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
GET https://api.gateway.cash/merchantid
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea
  </pre>
  <pre class="code">
GET https://api.gateway.cash/getmerchantid
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73ffffffffffffffffff
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "merchantID": "deadbeef20181111"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "eror": "Invalid API Key",
  "description": "No user currently has that API key.
  You might have changed your API key in your account settings, or the API key
  might be invalid."
}
  </pre>
  <h3 id="getusername">GET /username</h3>
  <p>Returns the username of a user given their API key.</p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
GET https://api.gateway.cash/username
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea
  </pre>
  <pre class="code">
GET https://api.gateway.cash/username
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73ffffffffffffffffff
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "username": "JohnGalt12"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "eror": "Invalid API Key",
  "description": "No user currently has that API key.
  You might have changed your API key in your account settings, or the API key
  might be invalid."
}
  </pre>
  <h3 id="postusername">POST /username</h3>
  <p>
    Sets a new username for the user. Usernames must be between 5 and 24
    characters, not contain spaces or special characters and be unique to the
    user.
  </p>
  <p>
    <b>BE AWARE:</b> Usernames will be translated to all lower case before
    being stored in the database. The username will be sent back in the
    response message.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
    <li>"username" is required</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
POST https://api.gateway.cash/username
{
  "APIKey": "aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea",
  "username": "pneumaultramicroscopic"
}
  </pre>
  <pre class="code">
POST https://api.gateway.cash/username
{
  "APIKey": "aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea",
  "username": "B!ll"
}
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "username": "pneumaultramicroscopic"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "eror": "Username In Use",
  "description": "Someone already has that username. Try another?"
}
  </pre>
  <h3 id="getpayments">GET /payments</h3>
  <p>
    Returns an array of all payments made to a merchant account, given their API
    key as a parameter.
  </p>
  <p>
    The includeUnpaid option (set to 'NO' by default) will return all payments,
    including those where the customer simply opened the dialog box and did not
    pay. This can be combined with the includeKeys option (discussed below) if
    you would like to process payments yourself.
  </p>
  <p>
    <b>BE AWARE:</b> Private keys are never included by default. You may always
    request that private keys for payment addresses be included by using the
    "includeKeys" parameter and giving a value of uppercase "YES". This may be
    useful if you'd like to process your own payments or for debugging.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
    <li>"includeKeys" is optional</li>
    <li>"includeUnpaid" is optional</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
GET https://api.gateway.cash/payments
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea
  </pre>
  <pre class="code">
GET https://api.gateway.cash/payments
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea
&includeKeys=YES
  </pre>
  <h4>Return Values</h4>
  <pre class="code">
{
  "status": "success",
  "numberOfPayments": 4,
  "payments": [
    {
      "paymentAddress":"bitcoincash:qqet0p878uc7e8trwvxqefgmqtkkvqzsvs4vrk4h9s",
      "paidAmount":9003,
      "paymentTXID":"ec396d7a28997df889a0c7dfda6d01740ba9e151ac4df182076185d844a687bc",
      "transferTXID":"8a17fc8f308cbc45e030e41cd0a8a393d9afd3aaf44d86093126f09cbce826fc",
      "paymentID": "order-fe43dcb493ac",
      "created": "2018-10-22T23:49:53.000Z",
      "paymentKey": "hidden"
    },
    {
      "paymentAddress":"bitcoincash:qqucfprkhtwknhhdvthj0jazk5f6erxmxqgjp4ht5q",
      "paidAmount":10000,
      "paymentTXID":"afee8509dc5139e28ae8e0ee0b1ea3b6e45aa62bce973a3f942281501cb9b526",
      "transferTXID":"bc0985d2b7b9ec955318a56cde3481d8beecd87bd325f0c78ee5f79ced96907e",
      "paymentID":"donation",
      "created":"2018-10-22T02:10:38.000Z",
      "paymentKey":"hidden"
    },
    {
      "paymentAddress":"bitcoincash:qzm62utwlfccx55qvm0lxjk4cq0x4ag3tsmc8h22jt",
      "paidAmount":9011,
      "paymentTXID":"526e318e120fc3d43faf2a502c6de88748457418051090b680ede4760b639f51",
      "transferTXID":"7974696486a82be8eebd14f3592f902a8f0ee3b50f6f15abace91faf7e548fa7",
      "paymentID":"null",
      "created":"2018-10-21T23:32:33.000Z",
      "paymentKey":"hidden"
    },
    {
      "paymentAddress":"bitcoincash:qphqgzujdyp7034q6p472wdyyxsy5k83hur9d425c9",
      "paidAmount":100000,
      "paymentTXID":"0544124297f8ebd0cf8652f3855bc94da57afa0fcbba99da84c07a015aedfc39",
      "transferTXID":"653ae98d262fde67a7fbef7ad103fd790d61f693ab617b71fe45400b64ed1e0f",
      "paymentID":"donation-0.001",
      "created":"2018-10-20T13:30:35.000Z",
      "paymentKey":"hidden"
    }
  ]
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "error": "No Results",
  "description": "No payments have been completed to this merchant yet. Make a
  test payment with /pay and see what happens!"
}
  </pre>
  <h3 id="getnewapikey">GET /newapikey</h3>
  <p>
    Generates a new API key for the user, given their old API key.
  </p>
  <p>
    <b>BE AWARE:</b> Once a new API key is generated, the old one becomes
    invalid immediately. All new requests must use the new API key. When you log
    in, your new API key is returned, not your old one. This endpoint might be
    useful for something like a "log out of all devices" feature.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
  </ul>
  <h4>Example</h4>
  <pre class="code">
GET https://api.gateway.cash/newapikey
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "newAPIKey": "deaddeaddeaddeaddeaddeaddeaddeaddeaddeaddeaddeaddeaddeaddeaddeff"
}
  </pre>
  <pre class="code">
{
  "status": "error",
  "error": "Invalid API Key",
  "description": "The API key you provided was not found in the database."
}
  </pre>
  <h3 id="gettotalsales">GET /totalsales</h3>
  <p>
    Returns the total of all payments that have been processed by this merchant
    account. The value returned is in units of satoshi.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
  </ul>
  <h4>Example</h4>
  <pre class="code">
GET https://api.gateway.cash/totalsales
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "totalSales": 133706969
}
  </pre>
  <h3 id="getaddress">GET /address</h3>
  <p>
    Returns the payout address for a merchant account
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
GET https://api.gateway.cash/address
?APIKey=aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status": "success",
  "payoutAddress": "bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng",
}
  </pre>
  <h3 id="postaddress">POST /address</h3>
  <p>
    Allows the user to set a new payout address for their account. If the new
    address is not in CashAddress format, it will be translated. The new
    address will be sent back in the response.
  </p>
  <h4>Parameters</h4>
  <ul>
    <li>"APIKey" is required</li>
    <li>"newAddress" is required</li>
  </ul>
  <h4>Examples</h4>
  <pre class="code">
POST https://api.gateway.cash/address
{
  "APIKey": "aaaa00001111ed3f8429e9b5c73122bed3f8429e9b5c73122bed3f842deaddea",
  "newAddress": "bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng"
}
  </pre>
  <h4>Return Value</h4>
  <pre class="code">
{
  "status", "success",
  "newAddress": "bitcoincash:pz3txlyql9vc08px98v69a7700g6aecj5gc0q3xhng"
}
  </pre>
</body>
</html>
